language: ruby
rvm:
  - 2.2.0
before_script:
  - npm install
  - npm install -g bower
  - bower install
script:
  - CODECLIMATE_REPO_TOKEN=6379678c9245d7c0695b4a011bac7e58e9a59ee91e5486af9e3ce494d3d7f9f8 bundle exec rspec
  - npm test
  - npm run gulp silent build
  - npm run gulp silent prod build
env:
  global:
    secure: SDeTgjE6C1ZJsYR28UdQwv5Kp+dM9oIv5zpKC2leAnMvbfPIcqRA745O5uiEkJBl5V3MN/O5QGOmcbTcprWr4A9E+fRx0c/PDxcij8excevxKQJPGSUGky8sB6EOzFoS1QJCNmUnU3LCCub5KJrTp86Pd9q6F5BeeSIdfwwP5mU=
after_success:
  - openssl aes-256-cbc -k '$DEPLOY_KEY' -in config/travis_id_rsa_enc -d -a -out config/travis_id_rsa
  - sh deploy.sh
